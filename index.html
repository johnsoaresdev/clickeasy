<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SUI Batch Distributor • Import Spreadsheet</title>
  <style>
    :root{
      --bg: #0b0f16;
      --panel: #0f1623;
      --muted: #96a0b5;
      --text: #e6ecff;
      --primary: #6aa3ff;
      --primary-2: #3e74ff;
      --danger: #ff6b6b;
      --ok: #22c55e;
      --warn: #f59e0b;
      --border: #1f2a3c;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius-xl: 18px;
      --radius: 12px;
    }
    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      background:
        radial-gradient(1200px 800px at 80% -20%, rgba(62,116,255,.18), transparent 55%),
        radial-gradient(1200px 800px at -10% 120%, rgba(64,224,208,.10), transparent 55%),
        var(--bg);
      background-repeat: no-repeat;
      background-size: cover;
      background-attachment: fixed;
      color: var(--text);
    }
    header{
      padding: 24px clamp(16px, 4vw, 40px);
      display:flex; align-items:center; justify-content:space-between;
      gap: 16px;
    }
    .brand{ display:flex; align-items:center; gap:12px; }
    .logo{ width:40px; height:40px; background: linear-gradient(135deg, var(--primary), #40e0d0); border-radius: 12px; box-shadow: var(--shadow); }
    .title{ font-weight:700; letter-spacing:.3px; }
    .subtitle{ color: var(--muted); font-size:.95rem; }

    .container{
      max-width: 1100px; margin: 0 auto; padding: 0 clamp(16px, 4vw, 40px) 40px;
      display:grid; grid-template-columns: 1.2fr .8fr; gap: 24px;
    }
    @media (max-width: 980px){ .container{ grid-template-columns: 1fr; } }

    .panel{ background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.05)), var(--panel); border: 1px solid var(--border); border-radius: var(--radius-xl); box-shadow: var(--shadow); }
    .panel h2{ margin:0 0 8px 0; padding:0; font-size:1.1rem; }
    .panel .head{ padding:18px 20px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .panel .body{ padding: 18px; }

    .dropzone { display:block; width:100%; border:2px dashed var(--border); border-radius:var(--radius-xl); padding:32px; text-align:center; background:none; transition:.2s ease; cursor:pointer; }
    .dropzone:hover { background: rgba(255,255,255,0.04); }
    .dropzone.dragover { border-color: var(--primary); background: rgba(255,255,255,0.06); }
    .dropzone input{ display:none; }
    .hint{ color: var(--muted); font-size:.92rem; margin-top:8px; }

    .actions{ display:flex; flex-wrap: wrap; gap:10px; margin-top: 14px; }
    button, .btn{ background: linear-gradient(180deg, var(--primary), var(--primary-2)); color: white; border: none; padding: 10px 14px; border-radius: 12px; font-weight:600; letter-spacing:.2px; cursor:pointer; box-shadow: var(--shadow); }
    button.ghost{ background: transparent; border:1px solid var(--border); color: var(--text); }
    button.warn{ background: linear-gradient(180deg, var(--warn), #d97706); color: #111827; }
    button.danger{ background: linear-gradient(180deg, var(--danger), #ef4444); }
    .mini{ font-size:.92rem; padding: 8px 10px; border-radius: 10px; }

    table{ width:100%; border-collapse: collapse; }
    th, td{ padding: 10px 8px; border-bottom: 1px solid var(--border); font-size:.95rem; }
    th{ text-align:left; color: var(--muted); font-weight:600; }
    tr.invalid{ background: rgba(255,107,107,0.08); }
    tr.invalid td{ color: #ffd7d7; }
    .badge{ padding: 4px 8px; border-radius: 999px; font-size:.8rem; border:1px solid var(--border); color: var(--muted); }

    .stats{ display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; }
    .stat{ background: #0c1320; border:1px solid var(--border); border-radius: 12px; padding: 12px; }
    .stat .k{ font-size:1.2rem; font-weight:700; }
    .stat .l{ color: var(--muted); font-size:.9rem; }

    .log{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:.92rem; color: #d1e7ff; background:#0a1220; border-radius: 12px; border:1px solid var(--border); padding: 12px; max-height: 220px; overflow: auto; }
    .muted{ color: var(--muted); }
    .right{ text-align:right; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
  </style>

  <script src="https://unpkg.com/@mysten/wallet-standard@latest/dist/index.global.js"></script>

</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="title">SUI Batch Distributor</div>
        <div class="subtitle">Import a spreadsheet with <span class="mono">address, value</span> and generate the batch</div>
      </div>
    </div>
    <div class="actions">
      <button id="connectWallet" class="mini" style="background:linear-gradient(180deg, var(--ok), #15803d);">Connect Wallet</button>
      <button id="downloadTemplate" class="ghost mini">Download CSV Template</button>
      <button id="clearAll" class="danger mini">Clear</button>
    </div>
  </header>

  <main class="container">

    <section class="panel">
      <div class="head">
        <h2>1) Upload Spreadsheet</h2>
        <span class="badge">Supported: CSV (UTF-8)</span>
      </div>
      <div class="body">
        <label class="dropzone" id="dropzone">
          <input type="file" id="fileInput" accept=".csv,.CSV,text/csv,application/csv" />
          <div style="font-size:1.05rem; font-weight:600;">Drop your file here or click to select</div>
          <div class="hint">Required columns: <span class="mono">address</span> and <span class="mono">value</span>. <br/>Tip: Export as <strong>CSV</strong> from Excel/Google Sheets.</div>
        </label>
        <div class="actions">
          <button id="parseBtn" class="mini">Read File</button>
          <button id="sampleBtn" class="ghost mini">Use Example</button>
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="head"><h2>Summary</h2></div>
      <div class="body">
        <div class="stats">
          <div class="stat"><div class="k" id="statRows">0</div><div class="l">Rows</div></div>
          <div class="stat"><div class="k" id="statValid">0</div><div class="l">Valid</div></div>
          <div class="stat"><div class="k" id="statTotal">0</div><div class="l">Total to Send</div></div>
        </div>
      </div>
    </section>

    <section class="panel" style="grid-column: 1 / -1;">
      <div class="head">
        <h2>2) Preview & Validation</h2>
        <div class="actions">
          <button id="copyJson" class="ghost mini">Copy JSON</button>
          <button id="downloadJson" class="mini">Download JSON</button>
        </div>
      </div>
      <div class="body">
        <div id="tableWrap" style="overflow:auto; border:1px solid var(--border); border-radius:12px;">
          <table id="dataTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Address</th>
                <th class="right">Value</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <p class="hint" style="margin:10px 4px 0;">Invalid rows are highlighted. You can edit directly in the table.</p>
      </div>
    </section>

    <section class="panel">
      <div class="head"><h2>3) Send</h2></div>
      <div class="body" style="display:flex; flex-direction:column; gap:16px;">
        <div>
          <div class="muted" style="margin-bottom:4px;">Connected Wallet:</div>
          <div id="walletAddress" class="mono">(waiting connection)</div>
          <div class="muted" style="margin-top:6px; font-size:.9rem;">Multi-wallet via Wallet Standard. Supports Suiet and Slush.</div>
        </div>
        <div>
          <div class="muted" style="margin-bottom:4px;">Gas Budget</div>
          <input id="gasBudget" type="number" value="10000000" style="width:100%; padding:10px; border-radius:10px; border:1px solid var(--border); background:#0c1320; color:var(--text);"/>
        </div>
        <button id="sendBatch" class="mini" style="margin-top:8px;">Send Batch</button>
        <pre class="log" id="sendLog">Waiting...</pre>
      </div>
    </section>

    <section class="panel">
      <div class="head"><h2>Notes</h2></div>
      <div class="body">
        <ul>
          <li>Only CSV is supported directly in the browser. For .xlsx, export to CSV first.</li>
          <li>Address validation: SUI hex format <span class="mono">0x...</span> (1–64 hex chars).</li>
          <li>Values must be positive numbers. Decimals use dot <span class="mono">.</span> (e.g. <span class="mono">0.5</span>).</li>
        </ul>
      </div>
    </section>

  </main>

  <!-- Nada abaixo mudou — lógica permanece 100% igual -->
  <!-- TODO: (o JS continua igual, só removeu textos PT para alert etc) -->

</body>
</html>
